{% extends "myapp/layout.html" %}
{% block title %}
My Card
{% endblock %}
{% block content %}

<div class="container mt-5">
  <h2 class="pb-1 border-bottom">ตะกร้าของฉัน</h2>
  {% if deletestatus == 'deleted' %}
  <div class="alert alert-danger">
    <strong>ลบเรียบร้อยแล้ว</strong> 
  </div>
  {% endif %}
  <table class="table table-striped table-hover" id="tb_mycart" name="tb_mycart">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Book</th>
        
        <th scope="col">Price</th>
        <th scope="col">Quantity</th>
        <th scope="col">Total</th>
        <th scope="col">Order Time</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      {% for cart in mycart %}
      <tr>
        <th scope="row">{{cart.bookid}}</th>
        <td>{{cart.bookname}}</td>
        
        <td>{{cart.price}}</td>
        <td>{{cart.quantity}}</td>
        <td>{{cart.total}}</td>
        <td>{{cart.stamp}}</td>
        <td> 
          <div  class="d-flex">
          <button type="submit" class="btn-warning btn-group-sm" id='btnclick'>EDIT</button>
          <form method="POST" id="form{{cart.bookid}}" onsubmit="return confirm('Are you sure to delete?!!');">
            {% comment %} cardid = bookid {% endcomment %}
            {% csrf_token %}
            <input type="hidden" value="{{cart.bookid}}" form="form{{cart.bookid}}" name="bookid" id="bookid">
            <button typu="button" class="btn-danger btn-group-sm">DELETE</button>
        </form>
        </style>
        </td>
      </tr>
      
      {% endfor %}  
      <tr>
        <th scope="row">&nbsp;</th>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>{{user.profile.cartquan}}</td>
        <td>{{user.profile.sumtotal}}</td>
        <td></td>
        <td>&nbsp;</td>
      </tr>
    </tbody>
  </table>
  <input type="text" value="" name="quan" id="quan">
 
</div>
{% endblock %}

{% block javascript %}
  <script>
    $(document).ready(function(){
      $('body').on('click','button',function(event) {
        //var rowindex = $(this).closest('tr').index();
        var row = $(this).closest("tr")[0];
        var quantCol = $(this).closest("tr")[0].cells[3]
        var totalCol = $(this).closest("tr")[0].cells[4]
        var quantity = row.cells[3].innerHTML;
        var totalprice = row.cells[4].innerHTML;
       // alert(row.cells[1].innerHTML);
       // row.cells[3].append('<input type="text" value="'+row.cells[3].innerHTML+'" name="quan" id="quan">');
        
        $('#quan')
                .clone().val(quantity) 
                .attr('style', 'margin:3px 0;', 'id', 'quantity')     
                .appendTo(quantCol);
                      
                // GIVE IT AN ID. + cc
        //var price = row.cells[2].innerHTML;
        //var quantity = row.cells[3].innerHTML;
        //var total = row.cells[4].innerHTML;
        //$('#quantity').val(quantity);
        //var totalprice  = quantity * quantity;
        //$('#total').val(10);
        //$('#tb_mycart tr').removeClass('highlight');
        //$(this).addClass('highligth');

      });
     

       // on('click,'#tb_mycart > tbody tr', 
      //function(){
      //  var row = $(this).closest("tr")[0];
      //  alert(row.cells[1].innerHTML);
     // })
  
    });
  </script>
{% endblock javascript%}